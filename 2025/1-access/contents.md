## 3Dセキュア

クレジットカードの不正利用を防止する本人認証サービス
3Dセキュア（1.0）では、カード情報に加えて、ワンタイムパスワード入力などをすることによって、さらに厳格な本人確認が行われます。その後、決済が完了となるので、カードの不正利用のリスクを低減することが可能
3Dセキュア2.0（EMV 3-Dセキュア）は、不正利用のリスクが高いと判断されたときのみ認証を行うリスクベース認証

## PW認証

本人だけが知りえる情報により、本人認証を行う

- ブルートフォース攻撃
  考えられる文字列をしらみつぶしに試す攻撃
- 辞書攻撃
  辞書にあるような意味のある単語で解読を試みる方法
- パスワードリスト攻撃
  外部から入手した利用者IDとPWの組み合わせを使ってログインを試行する方法
  サービスごとにPWを帰る等の対応しないとログインされる
- レインボー攻撃
  平文のPWとハッシュ値をチェーンにより管理するテーブルを用意し、PWがハッシュ値で保存されるケースで、対応するリストを不正に入手して突き合わせを行う

#### ワンタイムPW

##### S/Key方式

オープンソースで公開される公開される方式
パスフレーズ：サーバーとクライアントで管理する秘密の文字列
シード：サーバーからクライアントに送られる乱数
シーケンス番号：サーバーで管理するハッシュ巻子を使った計算する回数

1. 事前にサーバーに秘密のＰＷを登録(SSHつかうなどで)
2. ログイン時
   1. クライアントでＩＤ登録
   2. サーバーよりシードとシーケンス番号が返却
   3. クライアントでチャレンジコードとパスフレーズよりハッシュ計算
   4. サーバー側で登録されたパスフレーズにハッシュ計算→チェック

##### タイムスタンプ方式

トークン＝パスワード計算機を使った方式
トークンを使ったPWを生成した方式

##### チャレンジレスポンス方式

サーバーからチャレンジコードを送信してユーザー認証を安全に行う方式
クライアントから送信ｓるＰＷをハッシュ化する

1. ユーザーIDをサーバーに送信
2. サーバーはチャレンジコードをクライアントに送信
3. チャレンジコードを受信したクライアントはパスワードとチャレンジコードにハッシュ計算
4. 3のハッシュ値をサーバーに送信
5. サーバーで4のハッシュ値計算と同様の計算を行い、整合するかチェック
   S/Key方式、CHAP、SMTP-AUTHなどの認証に用いられる

## 検疫ネットワーク

IEEE802.1Xを応用することで検疫NWを構築できる

一定の基準を満たしていないと社内LANには接続できないようにできる

## IEEE802.1X

IEEE802.1Xとは、有線LANや無線LANにおけるユーザ認証の規格
当初は有線LANでクライアントPCをネットワーク接続する際にユーザ認証を行う目的で策定された規格
無線LANの初期においてはWEPによるセキュリティしかなかったため、WEPにはないユーザ認証などの仕組みが無線LAN環境においてセキュリティ的に最適であったことから有線LANよりも無線LAN環境で先に普及
※この認証の仕組みを使う場合、IEEE802.1Xに対応したＬＡＮスイッチや無線ＬＡＮ製品と認証サーバーが必要となる

#### IEEE802.1Xの構成要素

IEEE802.1X認証を行うためにはサプリカント、認証装置、認証サーバの3つの構成要素が必要

- サプリカント（Supplicant)

IEEE802.1Xにおけるクライアント。認証を受けるクライアントはPCにインストールする必要があるが、最近のPCには標準搭載されている。

- 認証装置(Authenticator)

サプリカントと認証サーバの仲介役となるネットワーク機器。IEEE802.1X対応のLANスイッチまたは無線LANアクセスポイントのこと。

- 認証サーバ(Authentication Server)

ユーザ認証を行うサーバのこと。IEEE802.1X/EAPに対応したRadiusサーバを使用する。

#### EAP

EAP（Extensible Authentication Protocol）は、ネットワークにアクセスする際の認証機能を拡張するためのフレームワーク
PPPは、ダイヤルアップ接続やVPNなどで使用されるプロトコルで、2つのポイント間でデータを送受信するための標準的な方法を提供します。EAPは、このPPPの認証部分を拡張し、より柔軟で強力な認証方法をサポートするために開発されました。

> PPP: 2つの機器間で直接の通信を行うための標準的な通信プロトコル。2つの機器間で直接の通信を行うための標準的な通信プロトコルである。しかし、単にデータをやり取りするだけでなく、様々な機能を備えていることで、信頼性、セキュリティ、効率性に優れた通信を実現
> __応用例__

- 企業内ネットワーク：多くの企業が社内のWi-Fiや有線LANのセキュリティを強化するためにEAPを使用しています。特に、EAP-TLSやPEAPなどのプロトコルが一般的です。
- 公共のWi-Fiネットワーク：カフェや空港などの公共のWi-Fiネットワークでも、ユーザー認証を行うためにEAPが利用されています。
  VPN接続：リモートワークが増える中、VPN接続時の認証にもEAPが使われています。これにより、外部からのアクセスでも高いセキュリティを確保できます。
- モバイルネットワーク：EAP-SIMやEAP-AKAなど、モバイルデバイスの認証にもEAPが利用されています。これにより、SIMカードを使った安全な認証が可能です。
  __特徴__
  EAPの柔軟性：
  EAPは、EAP-TLS、PEAP、EAP-TTLSなど、複数の認証方式をサポートしています。これにより、ネットワーク環境やセキュリティ要件に応じて最適な認証方式を選択できます。
  他の認証規格（例：PAP、CHAP）は、特定の認証方式に限定されており、柔軟性が低いです。
  セキュリティレベル：
  EAP-TLSなどの方式は、クライアントとサーバの両方が証明書を使用して相互認証を行うため、高いセキュリティを提供します。
  PAP（Password Authentication Protocol）は、パスワードを平文で送信するため、セキュリティが低いです。CHAP（Challenge-Handshake Authentication Protocol）は、パスワードをハッシュ化して送信しますが、EAPに比べるとセキュリティが劣ります。
  使用環境：
  EAPは、企業内ネットワーク、公共Wi-Fi、VPN、モバイルネットワークなど、さまざまな環境で使用されています。
  他の認証規格は、特定の環境（例：ダイヤルアップ接続）での使用が一般的です。

#### EAPOL **【EAP over LAN】**

[認証](https://e-words.jp/w/%E8%AA%8D%E8%A8%BC.html)[プロトコル](https://e-words.jp/w/%E3%83%97%E3%83%AD%E3%83%88%E3%82%B3%E3%83%AB.html)の[EAP](https://e-words.jp/w/EAP.html)を[イーサネット](https://e-words.jp/w/%E3%82%A4%E3%83%BC%E3%82%B5%E3%83%8D%E3%83%83%E3%83%88.html)([Ethernet](https://e-words.jp/w/%E3%82%A4%E3%83%BC%E3%82%B5%E3%83%8D%E3%83%83%E3%83%88.html))や[Wi-Fi](https://e-words.jp/w/Wi-Fi.html)などの[LAN](https://e-words.jp/w/LAN.html)を通じて利用するための標準仕様

企業などの組織内[ネットワーク](https://e-words.jp/w/%E3%83%8D%E3%83%83%E3%83%88%E3%83%AF%E3%83%BC%E3%82%AF.html)で[IEEE 802.1X認証](https://e-words.jp/w/IEEE_802.1X.html)を利用する際などに標準的に用いられる。

IEEE802.1X以外の認証規格

* **EAP (Extensible Authentication Protocol)** : これは、様々な認証方法をサポートするプロトコルで、PPP（Point-to-Point Protocol）を拡張したものです。EAPは、IEEE802.1X以外の規格でも利用されています。
* **PAP (Password Authentication Protocol)** : これは、IDとパスワードを平文で送信するシンプルな認証プロトコルです。
* **CHAP (Challenge-Handshake Authentication Protocol)** : これは、パスワードをハッシュ化して送信することでセキュリティを強化した認証プロトコルです。
* **RADIUS (Remote Authentication Dial-In User Service)** : これは、ネットワークアクセスの認証、承認、およびアカウンティングを提供するプロトコルです。

## ICカード

#### PIN

盗難防止のためにPINによる認証

ロックを解消するのは新たな鍵ペア生成、PINの再設定が必要となる

## SSO

個別に導入されたシステムが独立して稼働していると、ユーザーは何度もログイン手続きが必要となる。

→複数のサーバーに自由にアクセスできるようにする仕組みをSSOと呼ぶ

#### SAML認証

IDフェデレーション方式のSSO

記述はXMLを用いて、SAMLに対応したWEBサイトであれば異なるドメインにあるサイトでも認証情報が引き継がれる

OASISが標準化している仕様。ユーザにアサーションを発行する側をIDPという

ユーザーにIDPと連携しているSPにアクセスすると当該SPはユーザー経由でIDPに認証要求を出す

なりすましの防御策としてデジタル署名をしている

#### LDAPサーバー

[ディレクトリサービス](https://wa3.i-3-i.info/word12422.html)を提供する[サーバ](https://wa3.i-3-i.info/word144.html)のうち、[LDAP](https://wa3.i-3-i.info/word12692.html)に対応しているやつ

ディレクトリサービスは、[ネットワーク](https://wa3.i-3-i.info/word157.html)の世界における「俺がいろんな情報をまとめて管理しているから、なにか困ったことがあったら俺に聞いてこい」型[サービス](https://wa3.i-3-i.info/word11386.html)

LDAPはディレクトリサービスとやり取りするためのプロトコル

## OAuth

Webサービス間で認証連携を可能にする認可プロトコルのOAuthを使ってIDフェデレーションが可能

Oauthは、あるWEBサービスが保有するリソースを、利用者が別WEBサービスで利用できるように認可して連携するためのもの

→他WEBサービスの所有物を、別サービスでも利用できるプロトコル

４つのロールが規定される

- resource owner
- client
- resource server
- authorization server

##### CSRFの脅威

OauthではCSRFの攻撃をうける可能性がある

利用者と、Sサービスの間に攻撃者が関与し、clientを利用する際に、攻撃者のリソースと紐づけて情報窃取を行う攻撃

__stateパラメータ__

CSRF対策としてOAuth2.0ではstateパラメータの利用を推奨している

__OIDC__

OAuthは認証機能を持たない仕様。

OAuthの上に認証レイヤを実装したものがOIDC(認証レイヤ　マウンテッド　オン　OAuth)

## Kerberos認証

MS社のアクティブディレクトリで採用されている方式

MITで開発された手法

__内容__

レルムの範囲内で全体を管理するサーバでレルムの範囲内に存在するすべてのクライアントとサーバー間の認証を行う。

サーバーとクライアント間でSSOを実現が可能(やり取りの間にSVで認証と証書を発行することで)

KDC:Kerberosで全体を管理するサーバー。


## **フォーム認証**

**フォーム認証** （Form認証）とは、[Webサイト](https://e-words.jp/w/Web%E3%82%B5%E3%82%A4%E3%83%88.html)の認証方式の一つで、[Webページ](https://e-words.jp/w/Web%E3%83%9A%E3%83%BC%E3%82%B8.html)に[form](https://e-words.jp/w/%E3%83%95%E3%82%A9%E3%83%BC%E3%83%A0.html)[タグ](https://e-words.jp/w/%E3%82%BF%E3%82%B0.html)などで[ユーザー](https://e-words.jp/w/%E3%83%A6%E3%83%BC%E3%82%B6%E3%83%BC.html)名や[パスワード](https://e-words.jp/w/%E3%83%91%E3%82%B9%E3%83%AF%E3%83%BC%E3%83%89.html)などの[入力フォーム](https://e-words.jp/w/%E5%85%A5%E5%8A%9B%E3%83%95%E3%82%A9%E3%83%BC%E3%83%A0.html)を作り、[利用者](https://e-words.jp/w/%E3%83%A6%E3%83%BC%E3%82%B6%E3%83%BC.html)が内容を[入力](https://e-words.jp/w/%E5%85%A5%E5%8A%9B.html)して[Webサーバ](https://e-words.jp/w/Web%E3%82%B5%E3%83%BC%E3%83%90.html)に送信することで[認証](https://e-words.jp/w/%E8%AA%8D%E8%A8%BC.html)を[行](https://e-words.jp/w/%E8%A1%8C.html)うもの。

## IAM

識別・認証された利用者が許可されている権限の範囲内で利用できるように制御することをアクセスコントロール。

アクセスコントロールを実現するシステムのことをIAMと呼ぶ。

以前はファイアウォールで保護ざれた社内ネットワークのような閉鎖された環境化で利用されることが多かったが、クラウドサービスの利用増やテレワークの進展によりゼロトラストの考え方が主流となったことでクラウド型のIAMが求められることになった。

## IDaaS

IAMのうちクラウドサービスとして提供しているものをIDaaSという。
企業システムがオンプレミスとクラウドの混在環境に変化しているため、利用者が増えている。

### AAAフレームワーク
アクセスコントロールの際に必要となるこうせい要素をRFC2904では、AAAフレームワークとして規定している。
AAAは認証、認可、アカウンティングの３つ。
AAAを実装しているプロトコルはRADUSやDIAMETER。

### 認証技術

パスワード認証：固定のパスワードやアクセスするごとに変化するワンタイムパスワード

リスクベース認証：ログイン時の端末環境や場所時間帯などの情報からいつも通りかを判定して、いつも通り

IEEE802.1X認証：ネットワークに接続しようとしたデバイスが認められたデバイスかを認証する仕組み。手段はデジタル証明書やユーザー名とパスワードを用いるものがある。

多要素認証
記憶、所有、生体

3Dセキュア

インターネット上でクレジットカード決済を行う時に、カード情報だけでなく、あらかじめカード会社に登録しておいたパスワードを用いて認証する方式。

オンラインショップで商品購入時に、カード情報を入力後にすぐに決済に移るのではなく、あらかじめクレジットカード会社に登録したパスワードの入力を求め、2段階認証をすることで安全性を向上させている。

| プロトコル | 認証方式 | 安全な認証方式 |
| ----------- | ----------------------- | ----------------------- |
| TELNET | PWDを平文を送信 | プロトコルをSShに変更する |
| FTP | ID/PWDは平文で送信 | SSHを利用する |
| HTTP | そもそも認証しない | Digest認証 |
| SMTP | そもそも認証なし | SMTP-AUTH |
| POP3 | USER/PASSコマンド | APOPコマンド |
| SMTP-AUTH | SASL方式 |
| POP-AUTH | SASL方式 |
| IMAP4 | SASL方式 |


__SASL方式__

汎用的な認証メカニズム。
代表的な認証方式には以下があり、任意を選択可能

PLAIN 通常の平文による認証方式
LOGIN 通常の平文による認証方式
CRAM-MD5 チャレンジレスポンス方式で認証する方式
DIGEST-MD5 CRAM-MD5の改良版

ネットワークプロトコルにおける認証とセキュリティ機能を拡張するためのフレームワーク。

- 認証方式を抽象化：あくまでフレームワークで、実際の認証方式は複数存在
- プロトコル非依存：SASLはさまざまなアプリケーションプロトコルで利用可能
- 拡張性：新しい認証メカニズムを追加しやすい設計

__S/KEY方式__

OTP認証方式の一つ。
リプレイ攻撃を防ぐために設計された。

仕組み

- パスワードの使いまわしを防ぐために、毎回異なるパスワードを使う方式
- S/KEYはハッシュチェーンと呼ばれる仕組みを利用している

1. 利用者はシークレットとカウンタをもとにハッシュ関数を何度も李王してハッシュチェーンを作成
2. サーバ側には、ハッシュチェーンの先頭を登録しておく
3. 認証時、クライアントは一つ前のハッシュ値をサーバーに送信する
4. サーバは受け取った後にハッシュ関数を1回適用して、登録済みと一致するかを検証する
5. 一致すれば認証成功

タイムスタンプ方式
トークンと呼ばれるパスワード計算機を用いた方式。
サーバーで管理するパスワードを一定時間ごとに変化させて、毎回異なるパスワードでアクセスを可能とする。


### IEEE802.1X認証

モバイル端末をLANに接続する時になりすましや不正アクセスをふせぐため、強固な利用者認証が求められる。
これにより、不正な端末のLANへの接続を防ぐことができるようになる。

また、セキュリティ上問題を抱えた端末を検査して、治療した上で接続をおこなったりという用途で利用することが出来る。

__EAP__

認証にはPPPの認証部分を拡張したEAPを用いる。
EAPには次のような認証方式の種類がある。



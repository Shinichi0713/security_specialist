## ログに関する基礎

#### ログ運用ポイント概要

1. 監査ログ取得
2. システム使用状況
3. ログ情報の保護
4. 実務管理者および運用担当者の作業ログ
5. 障害ログ取得
6. クロックの同期

#### ログの役割とログに残すもの

ISMS適合性評価制度や内部統制報告制度、PCI　DSS認証など制度上からの要請もある。→目的によってどういうログを残すべきかは変化する。

#### ログを分析するための事前準備

インシデント発生時にログ分析するためには事前に準備しなくてはならないことがある。

###### 正確な時刻を設定する

各機器の複数のログを合わせて分析する場合や、統合ログ管理サーバーやSIEMを利用して集中管理する場合でも、機器の時刻を正確に保持することは重要。

用途に応じてNTPサーバーを導入して、個々のサーバーの時刻を合わせる必要がある。

###### X-Forward-Forヘッダフィールドを利用する

負荷分散装置やプロキシサーバーを介して通信を行う場合、送信元IPアドレスが付け替えされる。

WEBサーバーにアクセスする前に、LBやプロキシを介すると、送信元IPアドレスはLBやプロキシとなる。

経由する機器でX-Forward-Forを追加する設定を行い、経由したIPアドレスを取得するようにする。

###### 統合ログ管理サーバー

多数の機器のログデータを収集・保管するサーバーをログ管理サーバーや統合ログ管理サーバーと呼ぶ。

個々にログを保存しているとリスクも増大→多数の機器で管理しているログを統合ログサーバーに転送して一元管理する。

主要機能

1. 各サーバーのログ収集
2. ログの安全な保存機能
3. 圧縮による長期保存

###### SIEM

ファイアウォールやプロキシサーバー、CASBなどのログデータを収集、分析して、攻撃を検知する機能を高度化したセキュリティ機器をSIEM。

個々のログだけでは見えてこない異常を、複数のログデータを相関分析することで検出することが狙い。

機械学習やディープラーニングを使って異常な行動を学習してモデル化するUEBA。

ユーザーの行動分析をUBA。

セキュリティ運用の連携、自動化、効率化を行うSOAR。

SIEM主要機能

1. 統合ログサーバーと同等機能、ログ検索
2. 異常検知
3. アラート通知、レポート出力機能
4. SOAR

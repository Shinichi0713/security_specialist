**VXLAN（Virtual eXtensible Local Area Network）**は、一言でいうと **「物理的なネットワークの上に、仮想的なネットワークのトンネルを作る技術」** です。

主にデータセンターや大規模なクラウド基盤で使われており、従来のネットワーク技術（VLAN）では限界だった「場所の制約」や「数の制限」を打ち破るために生まれました。


### 1. VXLANが必要な理由（VLANの限界）

これまでネットワークを分けるには「VLAN」が使われてきましたが、2つの大きな壁がありました。

* **数の限界:** VLAN IDは12ビットしかないため、最大で **4,096個** までしかネットワークを分割できません。巨大なクラウドサービスでは、顧客ごとにネットワークを分けるとすぐに足りなくなります。
* **物理的な場所の制約:** VLANは「L2（レイヤー2）」の技術なので、ルーター（L3）を越えた先にある別のサーバー拠点へは、同じネットワークを延ばすのが困難でした。

### 2. VXLANの仕組み：L3の上でL2を運ぶ

VXLANの最大の特徴は、 **「L2（イーサネットフレーム）を、L3（UDPパケット）の中にカプセル化して運ぶ」** という点です。

1. **カプセル化:** 送信側のルーター（VTEPと呼ばれます）が、元の通信（イーサネットフレーム）を、UDPパケットという「封筒」の中に詰め込みます。
2. **配送:** 外側の封筒はIP（L3）パケットなので、物理的なルーターを何台越えても、世界中のどこへでも届けることができます。
3. **解除:** 受信側のVTEPが封筒を開け、中から元の通信を取り出します。

これによって、物理的には離れた場所にあるサーバー同士が、まるで**同じスイッチに繋がっているかのように**通信できるようになります。


### 3. VXLANのメリット

* **ネットワーク数が爆発的に増加:** VXLAN ID（VNI）は24ビットあり、最大で **約1,600万個** のネットワークを作ることができます。
* **物理構成からの自由:** 物理的な配線を変えることなく、ソフトウェアの設定だけで柔軟にネットワークを構築・移動できます。これは「仮想マシンのライブマイグレーション（起動したまま別の物理サーバーへ移動）」に欠かせない技術です。
* **既存設備の活用:** 外側の通信は普通のIPパケット（UDP）なので、既存の安価なルーターやスイッチをそのまま使って、高度な仮想ネットワークを構築できます。


### 4. VXLANの用語：VTEPとVNI

* **VTEP（VXLAN Tunnel End Point）:** カプセル化と解除を行う「トンネルの出入り口」です。物理スイッチや、サーバー内の仮想スイッチがこの役割を担います。
* **VNI（VXLAN Network Identifier）:** どの仮想ネットワークに属するかを示す24ビットのIDです。


### まとめ

* **VXLAN**は、IPネットワーク（L3）の上に仮想的なLAN（L2）のトンネルを掘る技術。
* **1,600万個**という膨大なネットワーク分割が可能。
* **クラウドの裏側**で、サーバーがどこに移動しても同じ設定で通信を続けられるように支えている。


## 組み合わせの個数

### 複数のサーバー間での共有
最も一般的なケースは、複数の物理サーバーや仮想サーバーの間で仮想IPアドレスを共有する組み合わせです。これは、サーバーの冗長化や負荷分散の目的で利用されます。例えば、ウェブサーバーが複数稼働している場合、一つの仮想IPアドレスをそのすべてのサーバーに割り当てて、外部から見ると単一のサービスとして機能させることができます。

### ネットワークインターフェース（NIC）への割り当て
一つの物理的なサーバーが複数のサービスを提供する場合、そのサーバーの単一のネットワークインターフェース（NIC）に複数のIPアドレスを割り当てることが可能です。この時、主要なIPアドレスとは別に、仮想IPアドレスをNICに追加設定します。これにより、サーバー内の異なるアプリケーションやサービスがそれぞれ独自のIPアドレスを持つかのように振る舞うことができます。

### 仮想ルーターへの設定
仮想ルーターにおいて、特定のVLANのIPアドレスと同一の仮想IPアドレスを設定するケースがあります。これは、仮想ルーターがIPアドレスの所有者となり、特定のネットワーク内でユニークなIPアドレスとして機能させるために行われます。

### クラウド環境での仮想マシン
Azureのようなクラウド環境では、仮想マシンに複数のプライベートIPアドレスやパブリックIPアドレスを割り当てる際に仮想IPアドレスが利用されます。これにより、仮想マシンの柔軟なネットワーク構成が可能になります。


## 広域イーサネット
「広域イーサネット」とは、通信事業者の専用ネットワーク（閉域網）を使って、**離れた場所にある拠点同士を、まるで「1つの大きなLAN」のように繋ぐサービス**のことです。

インターネットとの違いを、道路の例えと技術的なポイントで解説します。

---

### 1. インターネットとの決定的な違い

一言でいうと、インターネットは**「公共の道路（一般道）」**、広域イーサネットは**「特定の契約者だけが通れる専用のバイパス」**です。

| 比較項目 | インターネット（インターネットVPN） | 広域イーサネット |
| --- | --- | --- |
| **道路の種類** | **公共の道**。誰でも通れる。 | **専用の閉域網**。契約者のみ。 |
| **安全性** | 常に外部（ハッカー等）の危険がある。 | 外部から隔離されており、**極めて安全**。 |
| **速度・品質** | 混雑すると遅くなる（ベストエフォート）。 | 帯域保証型が多く、**常に高速・安定**。 |
| **管理範囲** | IPレベル（L3）での管理。 | LANレベル（L2）で自由自在に管理。 |

---

### 2. 広域イーサネットの「何がすごいの？」

技術的に最大の特徴は、**「レイヤー2（L2）」**で繋がっているという点です。

* **1つの大きなスイッチ:** 東京本社と大阪支店を、**1つの長いLANケーブルで直接繋いでいる**かのように扱えます。
* **プロトコルが自由:** インターネットは「IP」というルールに従う必要がありますが、広域イーサネットはL2で繋がっているため、IP以外の古い特殊な通信や、独自のルーティング設定（OSPFなど）もそのまま通せます。
* **ルーターが不要になることも:** 各拠点には、高価なルーターではなく、安価なスイッチングハブを置くだけでも拠点間通信が可能です。

---

### 3. メリットとデメリット

#### メリット

* **自由度が高い:** ネットワーク設計を自社で完全にコントロールできます。
* **セキュリティ:** 公衆網を通らないため、暗号化の手間をかけなくても情報漏洩のリスクが低いです。
* **低遅延:** 銀行の基幹システムや、リアルタイム性が求められる工場間通信などに最適です。

#### デメリット

* **コストが高い:** インターネットを流用するVPNに比べ、月額料金や初期費用が高額です。
* **管理が大変:** 自由度が高い反面、IPアドレスの割り振りやルーティング設定などをすべて自社のエンジニアが管理する必要があります。

---

### まとめ

* **広域イーサネット**は、拠点間を「1つのLAN」にする**超高速・高セキュリティ**な専用回線。
* **インターネット**は、安くてどこでも繋がるが、**混雑やセキュリティに弱点**がある。

「止まってはいけない、かつ情報の機密性が極めて高いビジネスネットワーク」を作りたい場合に、広域イーサネットが選ばれます。

**次は、広域イーサネットとよく比較される「IP-VPN」という、管理をプロバイダに任せられる別の専用網サービスとの違いについてお話ししましょうか？**
